qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,6)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit2,fit1)
qchisq(0.95,2)
f1<-ifelse(data$HSSEX==0&data$SMOKE==1,1,0)
f2<-ifelse(data$HSSEX==0&data$SMOKE==2,1,0)
f3<-ifelse(data$HSSEX==0&data$SMOKE==3,1,0)
m1<-ifelse(data$HSSEX==1&data$SMOKE==1,1,0)
m2<-ifelse(data$HSSEX==1&data$SMOKE==2,1,0)
m3<-ifelse(data$HSSEX==1&data$SMOKE==3,1,0)
fit<-glm(HBP~age+race+weight+height+chole+f2+f3+m1+m2+m3,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,5)
summary(fit)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit2,fit1)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,6)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit2,fit1)
qchisq(0.95,2)
qchisq(0.95,2)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke+race*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+race * smoke,family=binomial("logit"))
anova(fit2,fit1)
qchisq(0.95,2)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex * smoke,family=binomial("logit"))
anova(fit2,fit1)
qchisq(0.95,4)
anova(fit,fit1)
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit1)
qchisq(0.95,6)
fit_ex = glm(HBP~age+sex+race+weight+height+smoke+chole+height*weight,family=binomial("logit"))
anova(fit0,fit_ex)
qchisq(0.95,1)
cor(data,data)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
data<-read_xlsx("NHANES Dataset Smoking.xlsx")
#View(data)
colnames(data)
data<-data[-dim(data)[1],]
data<-data[,-c(1,2,3,4,13,14)]
data<-na.omit(data)
#View(data)
#par(mar=c(8,7,8,7))
png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
#par(new=TRUE)
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"),pch=c("o","o"), ncol=1)
dev.off()
print(table(data$HBP))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
# test data$PEPMNK5R+data$PEPMNK1R
#summary(glm(data$HBP~factor(data$SMOKE)+data$PEPMNK5R+data$PEPMNK1R,family=binomial("logit")))
print(cor(data$PEPMNK1R, data$PEPMNK5R))
library(RColorBrewer)
par(mfrow=c(1,3))
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
#barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Quit Smoking","Still Smoking"),col = brewer.pal(n = 2, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
HBP<-data$HBP
age<-data$HSAGEIR
sex<-as.factor(data$HSSEX)
race<-as.factor(data$DMARACER)
smoke<-as.factor(data$SMOKE)
weight<-data$BMPWTLBS
height<-data$BMPHTIN
chole<-data$TCP
cor(data,data)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke+race*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+race * smoke,family=binomial("logit"))
anova(fit2,fit1)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex * smoke,family=binomial("logit"))
anova(fit2,fit1)
qchisq(0.95,4)
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit1)
qchisq(0.95,6)
fit_ex = glm(HBP~age+sex+race+weight+height+smoke+chole+height*weight,family=binomial("logit"))
anova(fit0,fit_ex)
qchisq(0.95,1)
f1<-ifelse(data$HSSEX==0&data$SMOKE==1,1,0)
f2<-ifelse(data$HSSEX==0&data$SMOKE==2,1,0)
f3<-ifelse(data$HSSEX==0&data$SMOKE==3,1,0)
m1<-ifelse(data$HSSEX==1&data$SMOKE==1,1,0)
m2<-ifelse(data$HSSEX==1&data$SMOKE==2,1,0)
m3<-ifelse(data$HSSEX==1&data$SMOKE==3,1,0)
fit<-glm(HBP~age+race+weight+height+chole+f2+f3+m1+m2+m3,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,5)
summary(fit)
#par(mar=c(8,7,8,7))
#png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
#par(new=TRUE)
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"),pch=c("o","o"), ncol=1)
#dev.off()
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
#barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Quit Smoking","Still Smoking"),col = brewer.pal(n = 2, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
fit_33<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit0,fit_33)
qchisq(0.95,2)
summary(fit_33)
fit_34<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke+race*sex,family=binomial("logit"))
anova(fit_33,fit_34)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
data<-read_xlsx("NHANES Dataset Smoking.xlsx")
#View(data)
colnames(data)
data<-data[-dim(data)[1],]
data<-data[,-c(1,2,3,4,13,14)]
data<-na.omit(data)
#View(data)
#png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"), pch=c("o","o"), ncol=1)
#dev.off()
print(cor(data$PEPMNK1R, data$PEPMNK5R))
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
#barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Quit Smoking","Still Smoking"),col = brewer.pal(n = 2, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
HBP<-data$HBP
age<-data$HSAGEIR
sex<-as.factor(data$HSSEX)
race<-as.factor(data$DMARACER)
smoke<-as.factor(data$SMOKE)
weight<-data$BMPWTLBS
height<-data$BMPHTIN
chole<-data$TCP
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+weight+height+chole+race,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke,family=binomial("logit"))
summary(fit)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke+race*smoke,family=binomial("logit"))
summary(fit)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+race * sex,family=binomial("logit"))
anova(fit2,fit)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+race * sex,family=binomial("logit"))
anova(fit2,fit1)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+race * sex,family=binomial("logit"))
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit2,fit0)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+race * sex,family=binomial("logit"))
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit2)
qchisq(0.95,2)
fit2<-glm(HBP~age+sex+race+weight+height+smoke+chole+smoke * sex,family=binomial("logit"))
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit2)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit1)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke,family=binomial("logit"))
summary(fit)
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
anova(fit0,fit1)
f1<-ifelse(data$HSSEX==0&data$SMOKE==1,1,0)
f2<-ifelse(data$HSSEX==0&data$SMOKE==2,1,0)
f3<-ifelse(data$HSSEX==0&data$SMOKE==3,1,0)
m1<-ifelse(data$HSSEX==1&data$SMOKE==1,1,0)
m2<-ifelse(data$HSSEX==1&data$SMOKE==2,1,0)
m3<-ifelse(data$HSSEX==1&data$SMOKE==3,1,0)
fit<-glm(HBP~age+race+weight+height+chole+f2+f3+m1+m2+m3,family=binomial("logit"))
summary(fit)
fit<-glm(HBP~age+race+weight+height+chole+f2+f3+m1+m2+m3,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,5)
summary(fit)
test<-glm(HBP~age+race+weight+height+chole+sex*smoke,family=binomial("logit"))
TukeyHSD(test, "race")
exp(0.0780870)
fit
confint(fit)
0.081303106-0.0780870
0.003216106/0.0016272
exp(confint(mfit))
exp(confint(fit))
exp(0.074924002)
exp(fit$coefficients)
#png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999", pch="x")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"), pch=c("x","o"), ncol=1)
#dev.off()
#png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999", pch="x")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"), pch=c("x","o"), ncol=1)
#dev.off()
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
#barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Quit Smoking","Still Smoking"),col = brewer.pal(n = 2, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Never Smoked","Quit Smoking","Still Smoking"),col = brewer.pal(n = 3, name = "RdBu"))
#barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Quit Smoking","Still Smoking"),col = brewer.pal(n = 2, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
#barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = c("Quit Smoking","Still Smoking"),col = brewer.pal(n = 2, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
summary(data$HSAGEIR)
summary(data$BMPWTLBS)
summary(data$BMPHTIN)
summary(data$TCP)
table(data$HBP)
interaction.plot(data)
interaction.plot(data$SMOKE, data$HSSEX)
interaction.plot(data$SMOKE, data$HSSEX,data$HBP)
interaction.plot(data$SMOKE, data$HSSEX,data$DMARACER)
interaction.plot(data$HSSEX, data$HSSEX,data$DMARACER)
interaction.plot(data$HSSEX,data$DMARACER,data$HBP)
interaction.plot(data$SMOKE, data$HSSEX,data$HBP)
interaction.plot(data$SMOKE, data$HSSEX,data$HBP)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
data<-read_xlsx("NHANES Dataset Smoking.xlsx")
#View(data)
colnames(data)
data<-data[-dim(data)[1],]
data<-data[,-c(1,2,3,4,13,14)]
data<-na.omit(data)
#View(data)
#png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999", pch="x")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"), pch=c("x","o"), ncol=1)
#dev.off()
print(cor(data$PEPMNK1R, data$PEPMNK5R))
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
summary(data$HSAGEIR)
summary(data$BMPWTLBS)
summary(data$BMPHTIN)
summary(data$TCP)
HBP<-data$HBP
age<-data$HSAGEIR
sex<-as.factor(data$HSSEX)
race<-as.factor(data$DMARACER)
smoke<-as.factor(data$SMOKE)
weight<-data$BMPWTLBS
height<-data$BMPHTIN
chole<-data$TCP
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke,family=binomial("logit"))
summary(fit)
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
anova(fit0,fit1)
qchisq(0.95,2)
f1<-ifelse(data$HSSEX==0&data$SMOKE==1,1,0)
f2<-ifelse(data$HSSEX==0&data$SMOKE==2,1,0)
f3<-ifelse(data$HSSEX==0&data$SMOKE==3,1,0)
m1<-ifelse(data$HSSEX==1&data$SMOKE==1,1,0)
m2<-ifelse(data$HSSEX==1&data$SMOKE==2,1,0)
m3<-ifelse(data$HSSEX==1&data$SMOKE==3,1,0)
fit<-glm(HBP~age+race+weight+height+chole+f2+f3+m1+m2+m3,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,5)
summary(fit)
exp(fit$coefficients)
exp(confint(fit))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
data<-read_xlsx("NHANES Dataset Smoking.xlsx")
#View(data)
colnames(data)
data<-data[-dim(data)[1],]
data<-data[,-c(1,2,3,4,13,14)]
data<-na.omit(data)
#View(data)
#png("fig/SBP-DBP.png",width = 480, height = 400, units = "px")
plot(data[data$HBP==0,]$PEPMNK1R, data[data$HBP==0,]$PEPMNK5R,col = "#92C5DE" ,xlim=c(60,250), ylim=c(10,150),xlab='Average Systolic BP (mm Hg)', ylab='Average Diastolic BP (mm Hg)', main='Diastolic BP vs. Systolic BP')
points(data[data$HBP==1,]$PEPMNK1R, data[data$HBP==1,]$PEPMNK5R,col = "#FF9999", pch="x")
abline(v=140, lwd=3, lty=2)
legend(60,150,legend=c("HBP","No HBP"), col=c("#FF9999","#92C5DE"), pch=c("x","o"), ncol=1)
#dev.off()
print(cor(data$PEPMNK1R, data$PEPMNK5R))
library(RColorBrewer)
par(mfrow=c(2,2))
barplot(table(data$HBP), main = "High Blood Pressure", names.arg = c("No","Yes"), col = "#92C5DE")
barplot(table(data$HSSEX), main="Barplot of Sex", names.arg = c("Female","Male"),col = brewer.pal(n = 2, name = "RdBu"))
barplot(table(data$DMARACER), main="Barplot of Race",names.arg = c("White","Black","Other"),col = brewer.pal(n = 3, name = "RdBu"))
barplot(table(data$SMOKE), main="Barplot of Smoke", names.arg = gsub("\\s","\n",c("Never Smoked","Quit Smoking","Still Smoking")),col = brewer.pal(n = 3, name = "RdBu"))
par(mfrow=c(2,2))
boxplot(data$HSAGEIR, main="Boxplot of Age",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPWTLBS, main="Boxplot of Weight",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$BMPHTIN, main="Boxplot of Height",col = brewer.pal(n = 2, name = "RdBu"))
boxplot(data$TCP, main="Boxplot of TCP",col = brewer.pal(n = 2, name = "RdBu"))
summary(data$HSAGEIR)
summary(data$BMPWTLBS)
summary(data$BMPHTIN)
summary(data$TCP)
HBP<-data$HBP
age<-data$HSAGEIR
sex<-as.factor(data$HSSEX)
race<-as.factor(data$DMARACER)
smoke<-as.factor(data$SMOKE)
weight<-data$BMPWTLBS
height<-data$BMPHTIN
chole<-data$TCP
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+sex+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit1<-glm(HBP~age+sex+weight+height+smoke+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
fit<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*race+sex*smoke,family=binomial("logit"))
summary(fit)
fit0<-glm(HBP~age+sex+race+weight+height+smoke+chole,family=binomial("logit"))
anova(fit0,fit)
qchisq(0.95,4)
fit1<-glm(HBP~age+sex+race+weight+height+smoke+chole+sex*smoke,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,2)
anova(fit0,fit1)
qchisq(0.95,2)
f1<-ifelse(data$HSSEX==0&data$SMOKE==1,1,0)
f2<-ifelse(data$HSSEX==0&data$SMOKE==2,1,0)
f3<-ifelse(data$HSSEX==0&data$SMOKE==3,1,0)
m1<-ifelse(data$HSSEX==1&data$SMOKE==1,1,0)
m2<-ifelse(data$HSSEX==1&data$SMOKE==2,1,0)
m3<-ifelse(data$HSSEX==1&data$SMOKE==3,1,0)
fit<-glm(HBP~age+race+weight+height+chole+f2+f3+m1+m2+m3,family=binomial("logit"))
summary(fit)
fit1<-glm(HBP~age+race+weight+height+chole,family=binomial("logit"))
anova(fit1,fit)
qchisq(0.95,5)
summary(fit)
exp(fit$coefficients)
exp(confint(fit))
