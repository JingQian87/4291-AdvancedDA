for (i in 1:3){
for (j in (i+1):4){
#sprintf("i=%i, j=%i,95%% simultaneous confidence intervals:%.4f",i, j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1))
sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
print("i=%i, j=%i,95%% simultaneous confidence intervals:%.4f",i, j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
print("i=%i, j=%i,confidence intervals:%.4f",i, j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
print(c(i, j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
print(c(int(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
print(c(as.integer(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
print(c("i=",as.integer(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
cat("i=%i",i)
#print(c("i=",as.integer(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
cat("i=",i)
#print(c("i=",as.integer(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
cat("i =",i,", j =",j,", CI = (", CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1),")")
#print(c("i=",as.integer(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
cat("i =",i,", j =",j,", CI = (", CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1),")\n")
#print(c("i=",as.integer(i), j, CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,1)))
#sprintf("%.10f",0.25)
}
}
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
cat("i =",i,", j =",j,", CI = (", CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,6),")\n")
}
}
library(gdata)
data = read.xls("~/Desktop/4291-AdvancedDA/HW/HW2/HW2(Diets).xlsx", header=TRUE)
CI_Bonf = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.05/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
for (i in 1:3){
for (j in (i+1):4){
cat("i =",i,", j =",j,", CI = (", CI_Bonf(data[,2][data[,1]==i], data[,2][data[,1]==j],0.039096,29,4,6),")\n")
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
for (i in 1:3){
for (j in (i+1):4){
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
cat("i =",i,", j =",j,", CI = (", tmp>val, ")\n")
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
cat("i =",i,", j =",j,", CI = (", tmp>val, ")\n")
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
cat("i =",i,", j =",j,", (\frac{\hat{L}^2}{\widehat{Var(\hat{L})}} > (k-1)F_{\gamma}(k-1, n-k)):", tmp>val, "\n")
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
cat("i =",i,", j =",j,", Reject H0:", tmp>val, "\n")
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,",", s)
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
print(val)
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat(tmp, ", i =",i,", j =",j,",", s)
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
cat("Critical value is:", val)
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat(tmp, ", i =",i,", j =",j,",", s)
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
cat("Critical value is:", val,"\n")
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat(tmp, ", i =",i,", j =",j,",", s)
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
cat("Critical value is:", val,"\n")
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,", calculated value is: ",tmp,", ", s)
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
cat("Critical value is:", val,"\n")
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,", calculated value is: ",tmp,", ", s)
}
}
val = 3*0.039096*qf(1-0.05, df1=3, df2=25)
cat("Critical value is:", val,"\n")
for (i in 1:3){
for (j in (i+1):4){
yi = data[,2][data[,1]==i]
yj = data[,2][data[,1]==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,", calculated value is: ",tmp,". ", s)
}
}
anova(lm(data2$TimeLapse~factor(data2$Agent)))
data2 = read.table("~/Desktop/4291-AdvancedDA/HW/HW3/sofdrink.txt", header=TRUE)
anova(lm(data2$TimeLapse~factor(data2$Agent)))
t = qt(1-0.05/2, 95)
LSD15 = t*sqrt(7.52*2/20)
LSD15
pairwise.t.test(data2$TimeLapse,data2$Agent,pool.sd=TRUE,p.adjust.method="bonf")
pairwise.t.test(data2$TimeLapse,factor(data2$Agent),pool.sd=TRUE,p.adjust.method="bonf")
pairwise.t.test(data2$TimeLapse,data2$Agent,pool.sd=TRUE,p.adjust.method="bonf")
library(agricolae)
install.packages('agricolae')
library(agricolae)
library(agricolae)
fit.contrast(lm(data2$TimeLapse~factor(data2$Agent)), factor(data2$Agent), c(0.5,0.5,-0.5,-0.5,0), conf=0.95)
data2$TimeLapse[data2$Agent=1]
data2$TimeLapse[data2$Agent==1]
y1 = data2$TimeLapse[data2$Agent==1]
y2=data2$TimeLapse[data2$Agent==2]
y1
y2
y1+y2
(y1+y2)/2
g = 3
CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI1
CI2
CI3
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
cat("The 95 percent confidence interval for L1 is:"+CI1)
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
cat("The 95 percent confidence interval for L1 is:", CI1)
cat("The 95 percent confidence interval for L2 is:", CI2)
cat("The 95 percent confidence interval for L3 is:", CI3)
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
cat("The 95 percent confidence interval for L1 is:", CI1,".\n")
cat("The 95 percent confidence interval for L2 is:", CI2,".\n")
cat("The 95 percent confidence interval for L3 is:", CI3,".\n")
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
cat("The 95 percent confidence interval for L1 is: (", CI1,").\n")
cat("The 95 percent confidence interval for L2 is: (", CI2,").\n")
cat("The 95 percent confidence interval for L3 is: (", CI3,").\n")
CI_Bonf2 = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.1/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
cat("i =",1,", j =",3,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==3],7.52,100,5,3),")\n")
cat("i =",1,", j =",5,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==5],7.52,100,5,3),")\n")
cat("i =",3,", j =",5,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==3], data2$TimeLapse[data2$Agent==5],7.52,100,5,3),")\n")
val = 4*7.52*qf(1-0.05, df1=4, df2=95)
cat("Critical value is:", val,"\n")
for (i in 1:4){
for (j in (i+1):5){
yi = data2$TimeLapse[data2$Agent==i]
yj = data2$TimeLapse[data2$Agent==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val2){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,", calculated value is: ",tmp,". ", s)
}
}
val2 = 4*7.52*qf(1-0.05, df1=4, df2=95)
cat("Critical value is:", val2,"\n")
for (i in 1:4){
for (j in (i+1):5){
yi = data2$TimeLapse[data2$Agent==i]
yj = data2$TimeLapse[data2$Agent==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val2){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,", calculated value is: ",tmp,". ", s)
}
}
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
t = qt(1-0.05/(2*g), 100-5)
MSE = 7.52
SEL2 = sqrt(MSE * (0.5*0.5*2+1)/20)
Lhat2 = mean((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI2_2 = c(Lhat2 - t*SEL2, Lhat2 + t*SEL2)
print(CI2_2)
CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
cat("The 95 percent confidence interval for L1 is: (", CI1,").\n")
cat("The 95 percent confidence interval for L2 is: (", CI2,").\n")
cat("The 95 percent confidence interval for L3 is: (", CI3,").\n")
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
t = qt(1-0.05/(2*g), 100-5)
MSE = 7.52
SEL2 = sqrt(MSE * (0.5*0.5*2+1)/20)
dev = t * SEL2
Lhat2 = mean((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI2 = c(Lhat2 - dev, Lhat2 + dev)
Lhat3 = mean((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI3 = c(Lhat3 - dev, Lhat3 + dev)
print(CI3)
# CI2 = CI_Bonf((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
CI3 = CI_Bonf((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2,data2$TimeLapse[data2$Agent==5] , 7.52, 100, 5, g)
cat("The 95 percent confidence interval for L1 is: (", CI1,").\n")
cat("The 95 percent confidence interval for L2 is: (", CI2,").\n")
cat("The 95 percent confidence interval for L3 is: (", CI3,").\n")
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
t = qt(1-0.05/(2*g), 100-5)
MSE = 7.52
SEL2 = sqrt(MSE * (0.5*0.5*2+1)/20)
dev = t * SEL2
Lhat2 = mean((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI2 = c(Lhat2 - dev, Lhat2 + dev)
Lhat3 = mean((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI3 = c(Lhat3 - dev, Lhat3 + dev)
cat("The 95 percent confidence interval for L1 is: (", CI1,").\n")
cat("The 95 percent confidence interval for L2 is: (", CI2,").\n")
cat("The 95 percent confidence interval for L3 is: (", CI3,").\n")
CI_Bonf2 = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.1/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
cat("i =",1,", j =",3,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==3],7.52,100,5,3),")\n")
cat("i =",1,", j =",5,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==5],7.52,100,5,3),")\n")
cat("i =",3,", j =",5,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==3], data2$TimeLapse[data2$Agent==5],7.52,100,5,3),")\n")
fit.contrast(lm(data2$TimeLapse~factor(data2$Agent)), factor(data2$Agent), c(0.5,0.5,-0.5,-0.5,0), conf=0.95)
library(gmodels)
fit.contrast(lm(data2$TimeLapse~factor(data2$Agent)), factor(data2$Agent), c(0.5,0.5,-0.5,-0.5,0), conf=0.95)
qt(0.025,95)
qt(0.975,95)
library(gmodels)
fit.contrast(lm(data2$TimeLapse~factor(data2$Agent)), factor(data2$Agent), c(0.5,0.5,-0.5,-0.5,0), conf=0.95)
for (i in 1:4){
for (j in (i+1):5){
yi = data2$TimeLapse[data2$Agent==i]
yj = data2$TimeLapse[data2$Agent==j]
Lhat = mean(yi) - mean(yj)
ninv = 1/length(yi) + 1/length(yj)
tmp = Lhat*Lhat/ninv
if(tmp>val2){
s = "Reject H0\n"}
else{
s = "Accept H0\n"}
cat("i =",i,", j =",j,", calculated value is: ",tmp,". ", s)
}
}
CI_Bonf2 = function(yi, yj, MSE, n, k, g){
Lhat = mean(yi) - mean(yj)
t = qt(1-0.1/(2*g), n-k)
SEL = sqrt(MSE * (1/length(yi) + 1/length(yj)))
dev = t  * SEL
return(c(Lhat-dev, Lhat+dev))
}
cat("i =",1,", j =",3,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==3],7.52,100,5,3),")\n")
cat("i =",1,", j =",5,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==5],7.52,100,5,3),")\n")
cat("i =",3,", j =",5,", CI = (", CI_Bonf2(data2$TimeLapse[data2$Agent==3], data2$TimeLapse[data2$Agent==5],7.52,100,5,3),")\n")
g = 3
CI1 = CI_Bonf(data2$TimeLapse[data2$Agent==1], data2$TimeLapse[data2$Agent==2], 7.52, 100, 5, g)
t = qt(1-0.05/(2*g), 100-5)
MSE = 7.52
SEL2 = sqrt(MSE * (0.5*0.5*2+1)/20)
dev = t * SEL2
Lhat2 = mean((data2$TimeLapse[data2$Agent==1]+data2$TimeLapse[data2$Agent==2])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI2 = c(Lhat2 - dev, Lhat2 + dev)
Lhat3 = mean((data2$TimeLapse[data2$Agent==3]+data2$TimeLapse[data2$Agent==4])/2) - mean(data2$TimeLapse[data2$Agent==5])
CI3 = c(Lhat3 - dev, Lhat3 + dev)
cat("The 95 percent confidence interval for L1 is: (", CI1,").\n")
cat("The 95 percent confidence interval for L2 is: (", CI2,").\n")
cat("The 95 percent confidence interval for L3 is: (", CI3,").\n")
